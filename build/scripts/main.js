import{Funcionario}from"./funcionario.js";document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("aquivoEnviado");const c=document.getElementById("dadosDaTabela"),d=c.querySelector("tbody"),o=document.getElementById("formTabela"),r=document.getElementById("folhaSalarial");var t=document.getElementById("downloadButton"),n=document.getElementById("criarPlanilha");const i=document.getElementById("bemVindo"),s=document.getElementById("tabela");function ಠ_ಠ392(e){const o=document.createElement("tr");for(const a of[e.nome,e.cargo,e.salario]){var t=document.createElement("td");t.ಠ_ಠ397=a,o.appendChild(t)}var e=document.createElement("td"),n=(e.classList.add("tamanho"),document.createElement("button")),n=(n.ಠ_ಠ398='<i class="bi bi-pencil-square ಠ_ಠ394-0"></i>',n.addEventListener("click",function(){var e,t,n;e=o,t=e.querySelectorAll("td"),(n=document.getElementById("formTabela")).elements.name.ಠ_ಠ399=t[0].ಠ_ಠ397,n.elements.cargo.ಠ_ಠ399=t[1].ಠ_ಠ397,n.elements.salario.ಠ_ಠ399=t[2].ಠ_ಠ397,e.remove(),ಠ_ಠ395()}),e.appendChild(n),o.appendChild(e),document.createElement("td")),e=(n.classList.add("tamanho"),document.createElement("button"));e.ಠ_ಠ398='<i class="bi bi-trash btn ಠ_ಠ394-0"></i>',e.addEventListener("click",function(){ಠ_ಠ393(o)}),n.appendChild(e),o.appendChild(n),d.appendChild(o),ಠ_ಠ395()}function ಠ_ಠ393(e){var t=e.cells[2],t=(parseFloat(t.ಠ_ಠ397.replace("R$","").replace(/\./g,"").replace(",",".").trim()),e.remove(),d.querySelectorAll("tr td:nth-child(3)"));let n=0;t.forEach(e=>{e=parseFloat(e.ಠ_ಠ397.replace("R$","").replace(/\./g,"").replace(",",".").trim());n+=e}),r.querySelector("h2").ಠ_ಠ397=ಠ_ಠ396(n),ಠ_ಠ395()}function ಠ_ಠ394(){var e,t,n=Array.from(d.querySelectorAll("tr"));n.sort((e,t)=>e.cells[0].ಠ_ಠ397.localeCompare(t.cells[0].ಠ_ಠ397));for(e of n)d.appendChild(e);d.querySelectorAll("tr td:nth-child(3)").forEach(e=>{var t=parseFloat(e.ಠ_ಠ397.replace("R$","").replace(".","").replace(",",".").trim());e.ಠ_ಠ397=ಠ_ಠ396(t)});for(t of n){var o,a=t.cells[2];a.ಠ_ಠ397.startsWith("R$")||(o=a.ಠ_ಠ397,a.ಠ_ಠ397="R$ "+o)}n=function(){let t=0;var e=d.querySelectorAll("tr td:nth-child(3)");return e.forEach(e=>{e=parseFloat(e.ಠ_ಠ397.replace("R$","").replace(".","").replace(",",".").trim());t+=e}),ಠ_ಠ396(t)}();r.querySelector("h2").ಠ_ಠ397=""+n}function ಠ_ಠ395(){var e=d.querySelectorAll("tr").length;document.getElementById("totalFuncionarios").ಠ_ಠ397=e}function ಠ_ಠ396(e){return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}n.addEventListener("click",function(){var e=document.createElement("thead"),t=document.createElement("tr");for(const a of["Nome","Cargo","Salário"]){var n=document.createElement("th");n.ಠ_ಠ397=a,t.appendChild(n)}e.appendChild(t),c.appendChild(e);var e=XLSX.utils.aoa_to_sheet([["Nome","Cargo","Salário"]]),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,e,"Planilha Vazia"),new Blob([function(t){var e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;++e)n[e]=255&t.charCodeAt(e);return e}(XLSX.write(o,{bookType:"xlsx",type:"binary"}))],{type:"application/octet-stream"}),i.style.ಠ_ಠ403="none",s.style.ಠ_ಠ403="block",c.style.ಠ_ಠ403="table"}),e.addEventListener("change",function(e){var t,e=e.target.files[0];e&&((t=new FileReader).ಠ_ಠ405=function(e){var e=new Uint8Array(e.target.result),e=XLSX.read(e,{type:"array"}),t=e.SheetNames[0],e=e.Sheets[t],t=XLSX.utils.sheet_to_json(e,{header:1}),n=(console.log(t),t);for(let e=0;e<n.length;e++)if(0===e){var o,a=document.createElement("thead"),r=document.createElement("tr");for(o of n[e]){var ಠ_ಠ395=document.createElement("th");ಠ_ಠ395.ಠ_ಠ397=o,r.appendChild(ಠ_ಠ395)}a.appendChild(r),c.appendChild(a)}else ಠ_ಠ392(new Funcionario(n[e][0],n[e][1],n[e][2]));c.style.ಠ_ಠ403="table",d.querySelectorAll("tr button").forEach(e=>{e.addEventListener("click",function(){ಠ_ಠ393(e.closest("tr"))})}),ಠ_ಠ394(),i.style.ಠ_ಠ403="none",s.style.ಠ_ಠ403="block"},t.readAsArrayBuffer(e))}),o.addEventListener("submit",function(e){e.preventDefault();var e=document.getElementById("name").ಠ_ಠ399,t=document.getElementById("cargo").ಠ_ಠ399,n=document.getElementById("salario").ಠ_ಠ399;e&&t&&n?(ಠ_ಠ392(new Funcionario(e,t,n)),ಠ_ಠ394(),o.reset()):alert("Preencha todos os campos do formulário.")}),t.addEventListener("click",function(){var e=[];for(const r of c.querySelector("thead tr").cells)e.push(r.ಠ_ಠ397);var t=[];for(const ಠ_ಠ395 of c.querySelectorAll("tbody tr")){var n=[];for(let e=0;e<ಠ_ಠ395.cells.length-2;e++)n.push(ಠ_ಠ395.cells[e].ಠ_ಠ397);t.push(n)}var o=[e,...t],o=XLSX.utils.aoa_to_sheet(o),a=XLSX.utils.book_new(),o=(XLSX.utils.book_append_sheet(a,o,"Tabela"),XLSX.write(a,{bookType:"xlsx",type:"binary"}));a=new Blob([function(t){var e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e!==t.length;++e)n[e]=255&t.charCodeAt(e);return e}(o)],{type:"application/octet-stream"}),o=document.createElement("a");o.ಠ_ಠ406=URL.createObjectURL(a),o.ಠ_ಠ407="Funcionarios.xlsx",o.click()})});